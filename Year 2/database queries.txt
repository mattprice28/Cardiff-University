q1 SELECT STOCKNO, DESCRIPTION, QUANTITY FROM STOCKS WHERE QUANTITY > 25 ORDER BY QUANTITY ASC

q2 SELECT SUPPCODE, SUPPNAME FROM SUPPLIERS WHERE (TOWN= 'Swansea' OR TOWN = 'Cardiff')

q3 SELECT * FROM SUPPLIERS WHERE (TELNO LIKE '081%' OR STREET LIKE '%road%')

q4 SELECT STOCKS.STORECODE, SUM(STOCKS.QUANTITY) as TOTALSTOCK, ROUND(AVG(SUPPLYITEMS.PRICE), 2)
as AVERAGEPRICE  
FROM STOCKS INNER JOIN SUPPLYITEMS
ON STOCKS.STOCKNO=SUPPLYITEMS.STOCKNO GROUP BY STORECODE

q5 SELECT STOCKS.STORECODE FROM STOCKS INNER JOIN SUPPLYITEMS 
ON STOCKS.STOCKNO=SUPPLYITEMS.STOCKNO
GROUP BY STOCKS.STORECODE HAVING COUNT( DISTINCT SUPPLYITEMS.SUPPCODE) >= 3

q6 SELECT SUPPNAME, REPLACE( STREET||', '||TOWN||', '||COUNTY||', '||
POSTCODE, ', ,', ', ') as ADDRESS 
FROM SUPPLIERS

q7 SELECT S.STORECODE FROM STORES S 
WHERE S.STORECODE NOT IN (
SELECT S.STORECODE FROM STORES S, STOCKS STK, SUPPLIERS SP
WHERE S.STORECODE = STK.STORECODE 
AND STK.SUPPCODE = SP.SUPPCODE 
AND SP.TOWN='Cardiff');

q8 SELECT STK.STOCKNO, STK.DESCRIPTION, SPI.PRICE FROM STOCKS STK, SUPPLYITEMS SPI
WHERE STK.STOCKNO = SPI.STOCKNO
AND SPI.PRICE >(SELECT AVG(PRICE) FROM SUPPLYITEMS)
AND STK.STORECODE = 'LEG'

q9 SELECT STK.STOCKNO, STK.DESCRIPTION, OI.QTYORD FROM STOCKS STK 
LEFT OUTER JOIN ORDERITEMS OI
ON STK.STOCKNO = OI.STOCKNO
ORDER BY STK.STOCKNO ASC

q10 select storecode, max(description), max(price) from stocks
group by storecode

/* Reporting Exercise */
CLEAR SCREEN;
CLEAR BREAKS;
ACCEPT REPORT_FILE CHAR PROMPT ’ENTER A FILE NAME FOR REPORT ’;
/* set up column headers */
COL STORECODE FORMAT A21 HEADING 'Store Code';
COL DESCRIPTION FORMAT A20 HEADING 'Item Description' WORD_WRAPPED;
COL PRICE FORMAT $990.99 HEADING 'Price';
COL QUANTITY FORMAT 9999 HEADING 'Quantity';
COL QUANTITY*PRICE FORMAT $9990.99 HEADING 'Value';
/* set up report features */
SET PAUSE OFF;
SET PAGESIZE 60;
SET LINESIZE 82;
SET FEEDBACK OFF;
SET SPACE ' ';
TTITLE CENTER 'Current Stock Value By Store' SKIP 2 -
CENTER 'prepared by Matthew' SKIP 2 -
CENTER _DATE SKIP 3
BTITLE CENTER FORMAT 999 SQL.PNO;
/* set breaks and computes */
BREAK ON STORECODE SKIP 2 ON REPORT SKIP 2;
COMPUTE SUM OF QUANTITY*PRICE ON STORECODE;
COMPUTE SUM OF QUANTITY*PRICE ON REPORT;
/* Select table data */
SPOOL &REPORT_FILE;
SELECT STORECODE, DESCRIPTION, PRICE, QUANTITY, QUANTITY*PRICE
FROM STOCKS 
ORDER BY STORECODE;
SPOOL OFF;
/* Clear all settings */
CLEAR BREAKS;
CLEAR COLUMNS;
CLEAR COMPUTES;
SET FEEDBACK ON;
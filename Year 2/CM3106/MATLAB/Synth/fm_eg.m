% FM.m%% A Matlab script to calculate frequency modulated waveforms and% view their spectra.%% by Gary Scavone, McGill University, 2004.clear all;close all;% Signal parametersfs = 22050;T = 1/fs;dur = 2.0;      % secondst = 0:T:dur;    % time vector% FM parametersfc = 440;      % center freqfm = 30;Imin = 0;Imax = 20;I = t.*(Imax - Imin)/dur + Imin;y = sin(2*pi*fc*t + I.*sin(2*pi*fm*t));plot(t(1:10000), y(1:10000));sound(y, fs);dospectrum = input('\nPlot spectrum? Y/[N]:\n\n', 's');if dospectrum == 'Y',  figure(2); specgram(y(1:440), 512, fs, [], 256)end